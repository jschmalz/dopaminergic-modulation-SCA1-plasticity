clearvars
clc
clear -all


omt_6brapb_35min = [2.793296089385475, 1.088
3.3519553072625676, 1.192
4.35754189944134, 1.1119999999999999
4.804469273743017, 1.1999999999999997
5.810055865921786, 1.1439999999999997
6.703910614525139, 1.1039999999999999
7.150837988826815, 1.1839999999999997
8.156424581005584, 1.1999999999999997
8.71508379888268, 1.1039999999999999
10.05586592178771, 1.048
11.1731843575419, 1.1839999999999997
11.843575418994416, 1.152
12.737430167597765, 1.1039999999999999
13.519553072625694, 1.192
14.301675977653634, 1.136
14.860335195530727, 1.088
14.972067039106147, 1.408
14.860335195530727, 2.2159999999999997
15.41899441340782, 2.1199999999999997
15.64245810055866, 2.048
16.31284916201118, 1.9759999999999998
16.424581005586592, 1.944
16.983240223463692, 1.8639999999999999
17.318435754189945, 1.8079999999999998
18.324022346368718, 1.8319999999999999
18.324022346368718, 1.7679999999999998
19.553072625698324, 1.7839999999999998
19.999999999999996, 1.6959999999999997
20.782122905027936, 1.6079999999999999
21.56424581005587, 1.7119999999999997
22.122905027932962, 1.5679999999999998
22.793296089385475, 1.6319999999999997
23.575418994413415, 1.5519999999999998
23.910614525139668, 1.704
24.6927374301676, 1.5999999999999999
25.810055865921793, 1.648
26.368715083798886, 1.5999999999999999
27.0391061452514, 1.5519999999999998
27.70949720670391, 1.656
28.268156424581004, 1.5759999999999998
28.938547486033517, 1.648
29.83240223463687, 1.664
30.055865921787717, 1.5839999999999999
30.502793296089383, 1.4719999999999998
31.173184357541903, 1.5599999999999998
32.62569832402235, 1.648
32.62569832402235, 1.5679999999999998
33.184357541899445, 1.4719999999999998
34.18994413407822, 1.5359999999999998
35.19553072625699, 1.6319999999999997
35.53072625698324, 1.5439999999999998
36.312849162011176, 1.4719999999999998
36.759776536312856, 1.5839999999999999
37.6536312849162, 1.4799999999999998
38.212290502793294, 1.5679999999999998
38.659217877094974, 1.6159999999999999
39.553072625698334, 1.5359999999999998
40.22346368715084, 1.4799999999999998
40.44692737430168, 1.6079999999999999
41.22905027932961, 1.4879999999999998
41.787709497206706, 1.5679999999999998
42.68156424581005, 1.4719999999999998
43.12849162011173, 1.5279999999999998
44.02234636871509, 1.424
44.6927374301676, 1.504
45.58659217877096, 1.448
46.81564245810057, 1.5359999999999998
47.48603351955309, 1.4399999999999997
48.71508379888269, 1.4879999999999998
48.93854748603353, 1.432
49.49720670391062, 1.504
49.9441340782123, 1.5679999999999998
50.27932960893855, 1.432
50.72625698324023, 1.392
52.51396648044694, 1.4879999999999998
52.96089385474862, 1.424
54.078212290502805, 1.5599999999999998
54.41340782122906, 1.4879999999999998
55.41899441340783, 1.4719999999999998
56.983240223463696, 1.504
57.653631284916216, 1.4399999999999997
58.212290502793294, 1.5359999999999998
60.33519553072627, 1.5839999999999999
60.44692737430168, 1.4879999999999998
61.45251396648045, 1.448
61.67597765363129, 1.5359999999999998
63.128491620111745, 1.5519999999999998
64.13407821229052, 1.3999999999999997
64.91620111731844, 1.4719999999999998
65.8100558659218, 1.5359999999999998
66.59217877094973, 1.432
68.1564245810056, 1.392
68.1564245810056, 1.504
68.93854748603353, 1.4559999999999997
70.16759776536314, 1.5119999999999998
71.06145251396649, 1.408
71.50837988826817, 1.3359999999999999
72.62569832402235, 1.4719999999999998
73.51955307262571, 1.376
74.18994413407823, 1.4559999999999997
75.30726256983242, 1.408
75.41899441340783, 1.3199999999999998
76.20111731843578, 1.264
76.9832402234637, 1.3359999999999999
77.43016759776538, 1.4399999999999997
78.43575418994415, 1.3519999999999999
80.4469273743017, 1.52
80.67039106145253, 1.4559999999999997
81.34078212290504, 1.3519999999999999
82.12290502793297, 1.4559999999999997
82.45810055865923, 1.3119999999999998
84.0223463687151, 1.424
84.69273743016761, 1.3439999999999999
85.8100558659218, 1.3119999999999998
86.48044692737432, 1.4159999999999997
87.5977653631285, 1.3439999999999999
88.82681564245812, 1.3599999999999997
89.16201117318437, 1.3279999999999998
90.27932960893855, 1.264
91.17318435754191, 1.3199999999999998
91.84357541899443, 1.288
93.07262569832403, 1.392
93.29608938547487, 1.3279999999999998
94.52513966480448, 1.2799999999999998
95.08379888268158, 1.3439999999999999];

% load data
load('APB_5.mat')
td_1 = APB_5(:,1);
xd_1 = APB_5(:,2);


load('otmakova_1998_wHFS.mat')
load('otmakova_1998_apb.mat')
tw_1 = otmakova_1998_wHFS(:,1);
xw_1 = otmakova_1998_wHFS(:,2);
tw_2 = otmakova_1998_apb(:,1);
xw_2 = otmakova_1998_apb(:,2);



% load model

load('t_APB.mat')
load('fEPSP_APB5.mat')

fEPSP_1 = fEPSP_APB5;
t_1 = t_APB;

load('t_APB5_m5.mat')
load('t_APB5_m5_keinDA.mat')
load('fEPSP_APB5_m5.mat')
load('fEPSP_APB5_m5_keinDA.mat')

fEPSP_2 = fEPSP_APB5_m5;
t_2 = t_APB5_m5;
fEPSP_2_keinDA = fEPSP_APB5_m5_keinDA;
t_2_keinDA = t_APB5_m5_keinDA;


load('t_APB5_m5_keinDA_hand.mat')
load('t_APB5_m5_hand.mat')
load('fEPSP_APB5_m5_keinDA_hand.mat')
load('fEPSP_APB5_m5_hand.mat')

fEPSP_3 = fEPSP_APB5_m5_hand;
t_3 = t_APB5_m5_hand;
fEPSP_3_keinDA = fEPSP_APB5_m5_keinDA_hand;
t_3_keinDA = t_APB5_m5_keinDA_hand;

load('t_APB5_35_keinDA_hand.mat')
load('t_APB5_35_hand.mat')
load('fEPSP_APB5_35.mat')
load('fEPSP_APB5_35_keinDA.mat')

fEPSP_4 = fEPSP_APB5_35;
t_4 = t_APB5_35;
fEPSP_4_keinDA = fEPSP_APB5_35_keinDA;
t_4_keinDA = t_APB5_35_keinDA;


load('t_APB5_35_hand_keinDA_hand.mat')
load('t_APB5_35_hand_hand.mat')
load('fEPSP_APB5_35_hand.mat')
load('fEPSP_APB5_35_hand_keinDA.mat')

fEPSP_5 = fEPSP_APB5_35_hand;
t_5 = t_APB5_35_hand;
fEPSP_5_keinDA = fEPSP_APB5_35_hand_keinDA;
t_5_keinDA = t_APB5_35_hand_keinDA;



%% Figure 4

ls = 1.5;
ms = 6;

figure('DefaultAxesFontSize',14,'DefaultTextFontName','Calibri')
subplot(3,1,1)
plot(t_1/60000-2,fEPSP_1,'ks-',td_1,xd_1,'ro',...
    [0,5],[115,115],'g',[10,15],[115,115],'g',[20,25],[115,115],'g','LineWidth',ls,'MarkerSize',ms)
legend('Model','Shetty, 2016')
xlim([0,100])
ylim([90,130])
ylabel('fEPSP (% change)')
xlabel('Time (min)')

D1RA = -5*[1,0];
STIM = 0*[1,1];

subplot(3,2,3)
plot(otmakova_1998_wHFS(:,1),otmakova_1998_wHFS(:,2),'go',otmakova_1998_apb(:,1),otmakova_1998_apb(:,2),'r^',...,
        t_2/60000-10, fEPSP_2_keinDA,'ks-',t_2/60000-10, fEPSP_2,'b^-',...
        D1RA,[125,125],'g',STIM,[190,215],'k','LineWidth',ls,'MarkerSize',ms)
legend('(Otmakhova, 1998) - wHFS','(Otmakhova, 1998) - wHFS and 6-bromo-APB','(Model) - wHFS','(Model) - wHFS and 6-bromo-APB')
ylabel('fEPSP (% change)')
xlabel('Time (min)')
xlim([-6,45])
ylim([90,220])

subplot(3,2,4)
plot(otmakova_1998_wHFS(2:end,1),otmakova_1998_apb(:,2)-otmakova_1998_wHFS(2:end,2),'ro',...
    t_2/60000-10,fEPSP_2-fEPSP_2_keinDA,'ks-',...
    D1RA,[5,5],'g',STIM,[7,10],'k','LineWidth',ls,'MarkerSize',ms)
legend('Otmakhova, 1998','Model')
ylabel('\Delta fEPSP (% change)')
xlabel('Time (min)')
xlim([-6,45])
ylim([-5,15])


D1RA = [35,40];
STIM = 0*[1,1];



subplot(3,2,5)
plot(omt_6brapb_35min(:,1)-14,100*((omt_6brapb_35min(:,2))-(mean(omt_6brapb_35min(1:15,2)) -1 ) ),'r^',...,
        t_4/60000-10, fEPSP_4,'b^-',...
        D1RA,[110,110],'g',STIM,[190,215],'k','LineWidth',ls,'MarkerSize',ms)
legend('(Otmakhova, 1998) - wHFS and 6-bromo-APB','(Model) - wHFS and 6-bromo-APB')
ylabel('fEPSP (% change)')
xlabel('Time (min)')
xlim([-6,60])
ylim([90,220])

subplot(3,2,6)
plot(t_4/60000-10,fEPSP_4-fEPSP_4_keinDA,'ks-',...
    D1RA,[5,5],'g',STIM,[7,10],'k','LineWidth',ls,'MarkerSize',ms)
% legend()
ylabel('\Delta fEPSP (% change)')
xlabel('Time (min)')
xlim([-6,60])
ylim([-5,15])




%% Figure 5


D1RA = -5*[1,0];
STIM = 0*[1,1];

% D1RA = -5*[1,0];

figure('DefaultAxesFontSize',14,'DefaultTextFontName','Calibri')
subplot(2,1,1)
plot(otmakova_1998_wHFS(:,1),otmakova_1998_wHFS(:,2),'go',otmakova_1998_apb(:,1),otmakova_1998_apb(:,2),'r^',...,
        t_3/60000-10, fEPSP_3_keinDA,'ks-',t_3/60000-10, fEPSP_3,'b^-',...
        D1RA,[125,125],'g',STIM,[190,215],'k','LineWidth',ls,'MarkerSize',ms)
legend('(Otmakhova, 1998) - wHFS','(Otmakhova, 1998) - wHFS and 6-APB','(Model) - wHFS','(Model) - wHFS and 6-APB')
ylabel('fEPSP (% change)')
xlabel('Time (min)')
xlim([-6,45])
ylim([90,220])

subplot(2,1,2)
plot(otmakova_1998_wHFS(2:end,1),otmakova_1998_apb(:,2)-otmakova_1998_wHFS(2:end,2),'ro',...
    t_3/60000-10,fEPSP_3-fEPSP_3_keinDA,'ks-',...
    D1RA,[5,5],'g',STIM,[7,10],'k','LineWidth',ls,'MarkerSize',ms)
legend('Otmakhova, 1998','Model')
ylabel('\Delta fEPSP (% change)')
xlabel('Time (min)')
xlim([-6,45])
ylim([-5,15])

%% Figure 6

D1RA = [35,40];
STIM = 0*[1,1];

e = 1;
f = 15;

figure('DefaultAxesFontSize',14,'DefaultTextFontName','Calibri')
plot(omt_6brapb_35min(:,1)-14,100*((omt_6brapb_35min(:,2))-(mean(omt_6brapb_35min(1:15,2)) -1 ) ),'r^',...,
        t_5/60000-10, fEPSP_5,'b^-',...t_3/60000-10, fEPSP_3_keinDA,'ks-',...t_3/60000-10, fEPSP_3,'b^-',...t_4/60000-10, fEPSP_4_keinDA,'ks-',t_4/60000-10, fEPSP_4,'b^-',...
        D1RA,[110,110],'g',STIM,[190,215],'k','LineWidth',ls,'MarkerSize',ms)
legend('(Otmakhova, 1998) - wHFS and 6-bromo-APB','(Model) - wHFS and 6-bromo-APB')
ylabel('fEPSP (% change)')
xlabel('Time (min)')
xlim([-10,60])
ylim([90,220])

% subplot(2,2,4)
% plot(t_5/60000-10,fEPSP_5-fEPSP_5_keinDA,'ks-',...
%     D1RA,[5,5],'g',STIM,[7,10],'k','LineWidth',ls,'MarkerSize',ms)
% % legend('Otmakhova, 1998','Model')
% ylabel('\Delta fEPSP (% change)')
% xlabel('Time (min)')
% xlim([-6,60])
% ylim([-5,15])



