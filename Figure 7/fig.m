clearvars
clc
clear -all

%data
load('Sajikumar_SCH.mat')
load('Sajikumar_wHFS.mat')

load('wHFS_huang.mat')
load('wHFS_SCH_huang.mat')

load('control_huang.mat')
load('SCH_huang.mat')

error_HFS_SCH_huang = [0,
                    0,
                    0,
                    0,
                    (163.1-154)/2,
                    (161-149)/2,
                    (152.7-139.5)/2,
                    (142.4-121.7)/2,
                    (133.3-123)/2,
                    (138.7-122.9)/2,
                    (133.2-115.2)/2,
                    (122.9-104.3)/2,
                    (130.7-104.2)/2,
                    (131.4-107.9)/2,
                    (124.33-99.96)/2];

error_HFS_huang = [0,
                    0,
                    0,
                    0,
                    (206.9-158.6)/2,
                    (232.5-166)/2,
                    (238.3-173.8)/2,
                    (197.7-161)/2,
                    (191-161.4)/2,
                    (187.8-163.4)/2,
                    (187.4-160.4)/2,
                    (180.3-165.4)/2,
                    (178.5-148)/2,
                    (188.8-153.3)/2,
                    (180.1-155.7)/2];                
                

error_wHFS_huang = [0,
                    0,
                    0,
                    0,
                    (201.4-167.8)/2,
                    (169.7-158.9)/2,
                    (153.7-141.7)/2,
                    (149.6-140.4)/2,
                    (154.3-141.5)/2,
                    (153.9-135.1)/2,
                    (154.6-135.8)/2,
                    (153.6-134.8)/2];    
                
                
error_wHFS_SCH_huang = [0,
                    0,
                    0,
                    0,
                    (171.8-147.8)/2,
                    (166.1-153.3)/2,
                    (162.5-153.2)/2,
                    (158.4-150)/2,
                    (145.9-134.3)/2,
                    (154.7-135.9)/2,
                    (154.6-135.4)/2,
                    (134.8-117.2)/2];    
                
    

                
%%

e = [1.170229713597621, 143.3140370876876
1.10965136415075, 130.3464841592168,
0,0
0,0
12.206413277582499, 130.74708125319393
11.280855545050173, 120.11987913295151
16.29197605831081, 130.31286400284688
16.82228488789488, 118.83209783568951
21.542430706271546, 129.2383120819463
21.48781088299978, 117.54625616283329
25.05994732497345, 132.20671327282395
24.9934104493515, 117.96366333499539
30.897316801181745, 131.76861677366497
30.83276610095149, 117.95073250562234
44.910777277325906, 131.5249999482767
44.271228801198305, 119.62165427720804
60.103032848444485, 133.6172081408364
59.45653275844589, 120.22578262551698
74.68851183739841, 130.82130421379526
75.80176314444665, 119.12666212880764
90.45576518441428, 130.99897380938097
90.38823522109644, 116.54334103665944
105.61822812465735, 126.71369695515178
106.14456460345801, 114.38259944842257
120.20072785052375, 123.28004452343171
120.72309197854102, 110.09861567713067
135.97393972371472, 124.73321112837523
134.7464833316437, 111.98082720067201
151.14136810243699, 121.51084844861084
151.08575519146936, 109.60620969460487
165.7208885652158, 117.4394475122119
165.09425022913425, 108.29967869475178
179.71647346283467, 113.36933965875026
180.84859343610404, 105.71377143672895
195.47578210828377, 111.84634657519229
194.85510229837737, 103.98207476708993
210.06721962341285, 110.32593965750891
210.60050771608448, 99.48292199503045
225.83943840890797, 111.56652342755945
225.78283241024454, 99.44930183866052
239.83800256961442, 108.13416407877672
240.37029757459018, 97.07856358140529
255.01536182529517, 107.03762974794196
255.54765683027094, 95.98202925057053
270.7726842953525, 105.08947099459803
270.7240229982559, 94.67291208484282
284.7712484560591, 101.65711164581529
285.3075158118181, 91.45184248801574
299.3587136204046, 99.28637338856008
299.3219693756581, 91.42080849752043
314.5569277176984, 102.65407859047755
315.0941881611533, 92.66139226757096
330.32517415241, 103.04433102095624
331.44339089793743, 92.41260311043345
345.48167856647797, 97.48355715736925
344.8560333180923, 88.55637117480208
360.0810607831738, 97.66381291882959
361.7891716200364, 88.30628893472726];

T = e(1:end,1);
E = e(1:end-1,2)-e(2:end,2);
nI = size(T,1);
I = [1:2:nI];


error_saji_wHFS_sch = [0,0,0,0,0,E(I)'./2];

%%

e = [2.0438981158569334, 158.04616553295813
1.3938284819814726, 148.68299897563392
4.789659657240179, 149.08152342805843
3.618429382042507, 144.60567659956496
7.006894329155301, 144.18988754992347
4.708631147635288, 140.12407490533246
13.767250210052595, 141.52610407099203
10.90178746129854, 137.25815176731928
17.70081603996178, 138.86951417423433
14.815096163806487, 132.36219973988008
22.22552167857924, 139.06158281827285
21.59386761506852, 131.73420001611362
30.683793147105888, 136.5970615655537
31.188379775099804, 129.87753645707448
45.92636073800395, 134.11527571561757
45.29470667449331, 126.78789291345835
60.11555770403879, 140.1866590702439
61.14498808742786, 128.98697098396696
75.94558198957219, 140.14637501007104
75.84797946663906, 129.35672110769656
90.03349331860085, 135.02094771128992
89.94878169492301, 125.65634243753095
105.29631803690017, 134.77852399203528
105.773281309347, 125.00532325080857
119.98273540278302, 133.3160687361164
119.34003199705347, 124.76721568085817
135.25845102033765, 134.49869364547726
135.74830519203988, 126.15054153286604
150.53048352381938, 135.27416180380513
151.0184961384851, 126.72243131567741
165.25189047339524, 137.67969568269973
165.161654178608, 127.70435528239128
181.04508361819921, 133.5678441121969
179.82781441708966, 124.0025378957909
195.19560788646794, 135.36408158097674
196.80328717931008, 125.58800340688053
211.60203952441788, 136.5438290574681
210.94460366239662, 126.3663489980779
225.71941576603012, 134.67565576695097
225.07118768919122, 125.51606758514325
241.54944005156352, 134.6353717067781
242.0392942232658, 126.28721959416688
257.38498900820645, 135.20582277315472
258.4402011901062, 126.85623194410874
272.09166350149053, 135.98272964791732
269.756569179241, 127.84534949299633
285.6694635314158, 136.96609233106594
286.151951474972, 127.80362671638872
302.0630042701104, 136.72079117894182
303.1126917809007, 127.76046522334634
316.7512631930297, 135.46191429853943
315.55056800524846, 127.72881346178194
330.9054705753714, 137.66530851835228
331.93490095876064, 126.46562043207534
346.15724595145184, 136.20141454599866
344.9510260925613, 127.85757858269167
362.00752736438653, 138.40049261650728
360.80130750549586, 130.05665665320026];


T2 = e(1:end,1);
E2 = e(1:end-1,2)-e(2:end,2);
nI2 = size(T2,1);
I2 = [1:2:nI2];


error_saji_wHFS = [0,0,0,0,0,E2(I)'./2];



% model
load('t_wHFS_keinSCH.mat')
load('t_wHFS.mat')
load('t_SHFS_keinSCH.mat')
load('t_SHFS.mat')
load('fEPSP_wHFS_keinSCH.mat')
load('fEPSP_wHFS.mat')
load('fEPSP_SHFS_keinSCH.mat')
load('fEPSP_SHFS.mat')

t_1 = t_wHFS;
t_1_keinSCH = t_wHFS_keinSCH;
fEPSP_1 = fEPSP_wHFS;
fEPSP_1_keinSCH = fEPSP_wHFS_keinSCH;

t_2 = t_SHFS;
t_2_keinSCH = t_SHFS_keinSCH;
fEPSP_2 = fEPSP_SHFS;
fEPSP_2_keinSCH = fEPSP_SHFS_keinSCH;


% plot
ls = 1.5;
ms = 6;

STIM = 0*[1,1];


figure(1)%'DefaultAxesFontSize',14,'DefaultTextFontName','Calibri')
subplot(2,1,1)
plot(t_1/60000-32,fEPSP_1_keinSCH,'ks-',t_1_keinSCH/60000-32,fEPSP_1,'b^-',...
    wHFS_huang(:,1),wHFS_huang(:,2),'ro-',wHFS_SCH_huang(:,1),wHFS_SCH_huang(:,2),'cd-',...
    Sajikumar_wHFS(:,1),Sajikumar_wHFS(:,2),'m*-',Sajikumar_SCH(:,1),Sajikumar_SCH(:,2),'g>-',...
    STIM,[195,220],'k','LineWidth',ls,'MarkerSize',ms)
hold on
errorbar(wHFS_SCH_huang(:,1),wHFS_SCH_huang(:,2),(error_wHFS_SCH_huang).^1,'cd','LineWidth',ls,'MarkerSize',ms)
errorbar(wHFS_huang(:,1),wHFS_huang(:,2),(error_wHFS_huang).^1,'ro','LineWidth',ls,'MarkerSize',ms)
errorbar(Sajikumar_SCH(:,1),Sajikumar_SCH(:,2),(error_saji_wHFS_sch).^1,'g>','LineWidth',ls,'MarkerSize',ms)
errorbar(Sajikumar_wHFS(:,1),Sajikumar_wHFS(:,2),(error_saji_wHFS).^1,'m*','LineWidth',ls,'MarkerSize',ms)
legend('(Model) - weak HFS','(Model) - weak HFS and SCH',...
    '(Huang,1995) - weak HFS','(Huang,1995) - weak HFS and SCH',...
    '(Sajikumar, 2008) - weak HFS','(Sajikumar, 2008) - weak HFS and SCH')
ylabel('fEPSP (% change)')
xlabel('Time (min)')
xlim([-10,380])
ylim([80,225])


STIM = 0*[1,1];

subplot(2,1,2)
plot(t_2_keinSCH/60000-32,fEPSP_2_keinSCH,'ks-',t_2/60000-32,fEPSP_2,'b^-',...
    control_huang(:,1),control_huang(:,2),'ro-',SCH_huang(:,1),SCH_huang(:,2),'cd-',...
    STIM,[215,235],'k',STIM+10,[215,235],'k',STIM+20,[215,235],'k','LineWidth',ls,'MarkerSize',ms)
hold on
errorbar(SCH_huang(:,1),SCH_huang(:,2),(error_HFS_SCH_huang).^1,'cd','LineWidth',ls,'MarkerSize',ms)
errorbar(control_huang(:,1),control_huang(:,2),(error_HFS_huang).^1,'ro','LineWidth',ls,'MarkerSize',ms)
legend('(Model) - HFS','(Model) - HFS and SCH',...
    '(Huang,1995) - HFS','(Huang,1995) - HFS and SCH')
ylabel('fEPSP (% change)')
xlabel('Time (min)')
xlim([-10,380])
ylim([90,240])


